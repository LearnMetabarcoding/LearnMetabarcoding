

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Aligning protein coding genes &mdash; Analysis of Metagenetic data for Macroecology  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Concatenating alignments" href="concatenating_alignments.html" />
    <link rel="prev" title="2. Extracting protein coding genes" href="extracting_protein_coding_genes.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Analysis of Metagenetic data for Macroecology
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../notes.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linuxintro.html">Command line bioinformatics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readprocessing.html">Read processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filtering.html">Filtering Amplicon Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../otu_asv_read.html">OTUs, ASVs and Read Mapping</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../building_otu_phylogeny.html">Building OTU Phylogeny</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../otu_trees.html">Making a barcode tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../placing_otus_in_trees.html">OTU Phylogenetic Placement</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../trees.html">Building Phylogenetic Trees for Metagenetics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="preparing_mitogenome_data.html">1. Preparing mitogenome data</a></li>
<li class="toctree-l3"><a class="reference internal" href="extracting_protein_coding_genes.html">2. Extracting protein coding genes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3. Aligning protein coding genes</a></li>
<li class="toctree-l3"><a class="reference internal" href="concatenating_alignments.html">4. Concatenating alignments</a></li>
<li class="toctree-l3"><a class="reference internal" href="tree_building.html">5. Tree building</a></li>
<li class="toctree-l3"><a class="reference internal" href="tree_viewing.html">6. Tree Viewing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../otuid.html">Identifying OTU Sequences</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Analysis of Metagenetic data for Macroecology</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../building_otu_phylogeny.html">Building OTU Phylogeny</a> &raquo;</li>
        
          <li><a href="../trees.html">Building Phylogenetic Trees for Metagenetics</a> &raquo;</li>
        
      <li>3. Aligning protein coding genes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/otu_phylogeny/trees/aligning_protein_coding_genes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aligning-protein-coding-genes">
<span id="aligning"></span><h1>3. Aligning protein coding genes<a class="headerlink" href="#aligning-protein-coding-genes" title="Permalink to this headline">¶</a></h1>
<p>The sequences for each gene need to be aligned so that comparable regions are lined up. In phylogenetic terms, this means we need to ensure that the positions used for tree inference are homologous.</p>
<p>We will do a quick alignment using MAFFT for each gene, using the FFT-NS-2 method. First, make a directory to store your aligned genes.</p>
<p>Run the following command, making sure to replace <em>raw</em> with the name of the directory you extracted your genes into in the last step and ​new​ with the name of your new directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="k">for</span> f in ​dir​/*<span class="p">;</span> <span class="k">do</span> mafft --thread <span class="m">1</span> --retree <span class="m">2</span> --maxiterate <span class="m">0</span> <span class="nv">$f</span> &gt;​ new/​<span class="si">${</span><span class="nv">f</span><span class="p">#*/</span><span class="si">}</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>While this is running, have a look at the <a class="reference external" href="https://mafft.cbrc.jp/alignment/software/manual/manual.html">manual for mafft</a>. Have a look at the different methods for alignment and think about what might be best for these genes <a class="footnote-reference brackets" href="#f1" id="id1">1</a>.</p>
<p>Once it’s complete, pick one of your alignments and download it to your computer. Use an alignment viewer, such as AliView, to open the alignment.</p>
<ul class="simple">
<li><p>How does it look? Is the reading frame maintained?</p></li>
<li><p>Are all of the start and stop codons present and complete for all sequences, are they at the beginning or end of the sequences, and are they aligned properly? What might it mean if they aren’t?</p></li>
<li><p>Are there any sequences that look very out of place. If there were, what could this mean?</p></li>
</ul>
<p>Sequence alignment is a big topic, beyond the scope of this course. There is a wide range of software out there: two other commonly-used alignment tools are MUSCLE and CLUSTAL. We find MAFFT to be very versatile and fast for all sorts of alignment tasks. If doing this with your own data, you would generally try to optimise the gap opening parameters for each gene in order to generate an optimum alignment, and you might manually edit your alignment. Manual editing is used to remove sequencing errors, correct obvious misalignments and most importantly to check start/stop codons and ensure that codon positions are correctly maintained across the alignment.</p>
<p>Now we can <a class="reference internal" href="concatenating_alignments.html#concat-alignments"><span class="std std-ref">concatenate our alignments!</span></a></p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>We generally would use a global alignment, usually the GINSI method, optimising gap opening and extension penalties for each gene to reduce gap formation. Sometimes the LINSI method works better on poorly-aligning genes.</p>
</dd>
</dl>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="concatenating_alignments.html" class="btn btn-neutral float-right" title="4. Concatenating alignments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="extracting_protein_coding_genes.html" class="btn btn-neutral float-left" title="2. Extracting protein coding genes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Vogler Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>