

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Linkage-based clustering &mdash; Bioinformatic Methods for Biodiversity Metabarcoding  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bayesian clustering" href="bayesian.html" />
    <link rel="prev" title="Greedy Clustering" href="greedy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Bioinformatic Methods for Biodiversity Metabarcoding
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readprocessing.html">Read processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filtering.html">Filtering Amplicon Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../otu_asv_read.html">OTUs, ASVs and Read Mapping</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../otudelim.html">OTU Delimitation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="greedy.html">Greedy Clustering</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Linkage-based clustering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-swarm">Running SWARM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tracking-our-asvs">Tracking our ASVs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bayesian.html">Bayesian clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="comparing_otus.html">Comparing OTU delimitation methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../otudelim.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../otudelim.html#delimitation-methods">Delimitation methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../otudelim.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mapping_reads.html">Mapping reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../otu_asv_read.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../otu_asv_read.html#otus-or-asvs">OTUs or ASVs?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../otu_asv_read.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../building_otu_phylogeny.html">Building OTU Phylogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../otuid.html">Identifying OTU Sequences</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Bioinformatic Methods for Biodiversity Metabarcoding</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../otu_asv_read.html">OTUs, ASVs and Read Mapping</a> &raquo;</li>
        
          <li><a href="../otudelim.html">OTU Delimitation</a> &raquo;</li>
        
      <li>Linkage-based clustering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/otu_asvs_readmapping/otudelim/linkage_based.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linkage-based-clustering">
<span id="linkage-delimitation"></span><h1>Linkage-based clustering<a class="headerlink" href="#linkage-based-clustering" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The program <code class="docutils literal notranslate"><span class="pre">swarm</span></code> is a slightly different OTU delimitation algorithm. Rather than using a threshold that applies to all clusters like vsearch’s clustering method, it uses a local linking threshold that is based on number of differences, rather than overall dissimilarity. It assess the absolute number of differences between all pairs of ASVs, then builds a network where ASVs are nodes and the distance between nodes is the number of differences. It then interrogates this network to separate groups of ASVs with the most differences between them. One of the theoretical benefits of <code class="docutils literal notranslate"><span class="pre">swarm</span></code> is that it is not affected by the abundance distribution of the input ASVs and the clusters are therefore not necessarily as uneven as in greedy clustering. The downside is that <code class="docutils literal notranslate"><span class="pre">swarm</span></code> generally produces many more OTUs than greedy clustering, especially at the authors’ recommended settings. Of course, this could vary considerably depending on the dataset.</p>
</div>
<div class="section" id="running-swarm">
<h2>Running SWARM<a class="headerlink" href="#running-swarm" title="Permalink to this headline">¶</a></h2>
<p>SWARM is pretty easy to run. The main parameter is the <code class="docutils literal notranslate"><span class="pre">-d</span></code> parameter, which specifies the number of differences to iteratively group ASVs together. This should always be an integer greater than or equal to 1. Our input contains USEARCH/VSEARCH-style <code class="docutils literal notranslate"><span class="pre">;size=</span></code> tags so we use the <code class="docutils literal notranslate"><span class="pre">-z</span></code> parameter.</p>
<p>Run the following command to have SWARM cluster your input ASVs.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ swarm ​-z ​in.fasta -d <span class="m">1</span> -w ​out.fasta
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>What happens if you run with higher <code class="docutils literal notranslate"><span class="pre">-d</span></code> values? Are higher values more or less strict?
While the algorithm is quite different from greedy clustering, we can calculate the number of differences that 3% dissimilarity equates to given our amplicon is 418bp (the solution is below if you can’t figure it out). Run SWARM using this value for <code class="docutils literal notranslate"><span class="pre">-d</span></code>. How does the number of OTUs differ?</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<p><span class="math notranslate nohighlight">\(418 * 0.03 ≈ 13\)</span></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ swarm -z in.fasta -d <span class="m">13</span> -w out.fasta
</pre></div>
</div>
</div>
</div>
<div class="section" id="tracking-our-asvs">
<h2>Tracking our ASVs<a class="headerlink" href="#tracking-our-asvs" title="Permalink to this headline">¶</a></h2>
<p>We can get <code class="docutils literal notranslate"><span class="pre">swarm</span></code> to output a list of ASVs that were grouped to form each OTU. You can generate this list by adding the <code class="docutils literal notranslate"><span class="pre">-o</span></code> option</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Rerun <code class="docutils literal notranslate"><span class="pre">swarm</span></code> with your favourite <code class="docutils literal notranslate"><span class="pre">-d</span></code> value and <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">out.txt</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">out.txt</span></code> with an appropriate name, of course)
Review this file with <code class="docutils literal notranslate"><span class="pre">more</span></code>
Can you figure out a way to count the number of ASVs per OTU? Is it at all even?</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ swarm -z asvs.fasta -d <span class="m">1</span> -w swarm_otus.fasta -o swarm_asvmap.txt
$ more swarm_asvmap.txt
$ grep -n -o <span class="s2">&quot;uniq&quot;</span> swarm_asvmap.txt <span class="p">|</span> cut -d: -f1 <span class="p">|</span> sort <span class="p">|</span> uniq -c
</pre></div>
</div>
<p>Check out the page on <code class="docutils literal notranslate"><span class="pre">grep</span></code> for more help figuring out what this command is doing</p>
</div>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>We’ve generated a set of OTUs using one method. If you haven’t already, try out the other two types of OTU clustering: <a class="reference internal" href="greedy.html#greedy-clustering"><span class="std std-ref">Greedy Clustering</span></a> and <a class="reference internal" href="bayesian.html#bayesian-clustering"><span class="std std-ref">Bayesian Clustering</span></a>.</p>
<p>If you’ve now tried all three methods, the <a class="reference internal" href="comparing_otus.html#comparing-otus"><span class="std std-ref">Comparing OTU Delimitation methods</span></a> subsection outlines some ways to compare these methods and some hints for selecting a method and parameters. Once you have a final set of OTUs and an associated record of ASVs within each OTU, you can proceed with these two files to the <a class="reference internal" href="../mapping_reads.html#mapping-reads"><span class="std std-ref">Mapping Reads</span></a> section to learn about mapping your reads to your OTUs. Later on, we’ll also use the OTU sequences to generate a phylogeny of our OTUs in the <a class="reference internal" href="../../building_otu_phylogeny.html#phylogeny"><span class="std std-ref">Building OTU Phylogeny</span></a> section, and to retrieve taxonomic identifications and/or classifications for the OTU sequences in the <a class="reference internal" href="../../otuid.html#otuid"><span class="std std-ref">Identifying OTU Sequences</span></a> section.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bayesian.html" class="btn btn-neutral float-right" title="Bayesian clustering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="greedy.html" class="btn btn-neutral float-left" title="Greedy Clustering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Vogler Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br>The content of this site is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Creative Commons Attribution ShareAlike 4.0 License</a></p>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>