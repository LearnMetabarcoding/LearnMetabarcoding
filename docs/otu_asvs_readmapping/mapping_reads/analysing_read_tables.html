

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Analysing Read Tables &mdash; Bioinformatic Methods for Biodiversity Metabarcoding  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Building OTU Phylogeny" href="../../building_otu_phylogeny.html" />
    <link rel="prev" title="Mapping reads to OTUs" href="mapping_reads_otus.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Bioinformatic Methods for Biodiversity Metabarcoding
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readprocessing.html">Read processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filtering.html">Filtering Amplicon Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../otu_asv_read.html">OTUs, ASVs and Read Mapping</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../otudelim.html">OTU Delimitation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../mapping_reads.html">Mapping reads</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mapping_reads_asvs.html">Mapping reads to ASVs</a></li>
<li class="toctree-l3"><a class="reference internal" href="mapping_reads_otus.html">Mapping reads to OTUs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Analysing Read Tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../building_otu_phylogeny.html">Building OTU Phylogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../otuid.html">Identifying OTU Sequences</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Bioinformatic Methods for Biodiversity Metabarcoding</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../otu_asv_read.html">OTUs, ASVs and Read Mapping</a> &raquo;</li>
        
          <li><a href="../mapping_reads.html">Mapping reads</a> &raquo;</li>
        
      <li>Analysing Read Tables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/otu_asvs_readmapping/mapping_reads/analysing_read_tables.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="analysing-read-tables">
<span id="analysis"></span><h1>Analysing Read Tables<a class="headerlink" href="#analysing-read-tables" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Detailed guidance for cleaning and analysing read tables is beyond the scope of these resources, but we want to give you a broad introduction to the problems and some pointers for how to deal with them. The previous subsections detail how we can generate a reads table that records the number of reads for each of a set of ASVs or OTUs in each of a collection of samples. This table is analagous to the classic community matrix of community ecology, and is the community output from metabarcoding. However, while we have done our best to clean our sequence data to remove errors in the set of ASVs, there may well remain erroneous records within this community data table. Just because an ASV or OTU is valid for the entire dataset, does not mean that the individual counts per sample of that ASV or OTU necessarily accurately reflect biological reality.</p>
</div>
<div class="section" id="remaining-sources-of-error">
<h2>Remaining Sources of Error<a class="headerlink" href="#remaining-sources-of-error" title="Permalink to this headline">¶</a></h2>
<p>The reads table may be biased by several sources of error that inflate or deflate read counts such that comparisons between samples are not valid. One major concern is false positives, where an ASV or OTU is recorded in a sample when it is not actually present. This may be due to contamination or sequencing errors, particularly sequencing errors in the indices used for multiplexing. Contamination is very difficult to control for, especially if it occurs pre-PCR, as it is very challenging to know what occurences are valid or invalid from unknown samples. Here, negative controls comprised of no material, and positive controls comprised of a known set of specimens (ideally with reference barcodes) can help to identify widespread contamination. On the other hand, cross-talk, where multiplexing indices are mis-sequenced leading to incorrect read-to-sample assignment, may be somewhat ameliorated by looking at the frequency distribution of reads within an ASV or OTU and within a sample. As cross-talk is likely to happen at an overall low rate, very low occurences are likely to be errors.</p>
<p>Another major source of error is PCR bias and sequencing depth. In theory, the number of reads of an ASV or OTU should approximately reflect a function of the occurence and biomass of the source species or haplotype in the community, but both variation in primer affinity and stochastic variation in amplification and sequencing between different species and taxa may mean that relative read counts between ASVs and OTUs no longer reflect real variation. Furthermore, variation in the number of reads attained by different samples can result in substantial differences in the number of ASVs or OTUs recovered in different samples.</p>
</div>
<div class="section" id="cleaning-read-tables">
<h2>Cleaning Read Tables<a class="headerlink" href="#cleaning-read-tables" title="Permalink to this headline">¶</a></h2>
<p>There are several possible approaches for removing erroneous occurences from a table. One very common one is to remove any singleton record, i.e. if an ASV or OTU occurs with only a single read in a given sample, change this to 0. Another approach is to use a threshold of proportion of reads per sample, which may be more appropriate given that different samples may have substantially different total read counts. We would strongly suggest this latter approach, but caution that the threshold to be applied should not just be copied from another paper but should be carefully decided on based on the read count distributions of your data. In particular, we find that much lower thresholds are appropriate for very diverse datasets, while higher thresholds suit less diverse datasets. Positive and negative controls can be very helpful here. It is important to remember that false records observed within positive and negative controls are not necessarily evidence of widespread contamination, and simply removing an ASV or OTU completely if it is found in a negative control (or a positive control when it shouldn’t be) may be needlessly throwing away data. Instead, this may be evidence of cross-talk, and it may be that the reads of a valid ASV or OTU have been accidentally assigned to a positive or negative control from another sample with a similar index. This can be determined by careful examination of read count patterns across a dataset, keeping track of the indices used.</p>
</div>
<div class="section" id="standardising-read-counts">
<h2>Standardising Read Counts<a class="headerlink" href="#standardising-read-counts" title="Permalink to this headline">¶</a></h2>
<p>We know that the more deeply we sample, the more species we recover until our count levels off - this is the classic species accumulation pattern. The same is true of sequencing; for a given sample, the more we sequence, the more OTUs or ASVs we will see, and this will level off. The concern is that if different samples have been sequenced with different depths through chance variation in the sequencing process, different samples will have reached different points on this species accumulation curve, and will therefore not be comparable for the purposes of community ecology.</p>
<p>One approach to deal with this is rarefaction, which randomly removes reads from a sample until a target number of reads is met. In doing so, ASV or OTUs will be removed from a sample, but the theory is then that all of the samples in the dataset will have the same number of reads thus have reached the same effort in the species accumulation curve and the ASV or OTU counts will be comparable. Generally, this process will require some dropping of samples (that fail to meet the target number of reads) and loss of some ASVs or OTUs (that have all of their reads removed from all samples). This method is very good for producing statistically comparable data, and is very useful for studies undertaking methodological questions where precise comparison of appropriately comparable communities is required, with relatively little importance placed on the extent to which the inferred communities are representative of the real source communities. This method is also useful in highly diverse and poorly-known communities, such as microbiome studies, where reaching asymptotic richness requires very considerable sequencing and the classic accumulation pattern may not necessarily apply.</p>
<p>However, rarefaction neglects the reality of ecological communities and may lead to limited or even invalid analyses, particularly when considering metazoan or plant communities with well-understond accumulation patterns. There is no guarantee that ASV or OTU richness values at the arbitrary cut-off read target are consistent representations of true haplotypic or species richness of a sample, and different accumulation trajectories may intersect and thus have variable ratios of richness along the read axis (TODO: figure?). Furthermore, multivariate analyses of community composition become hampered when real shared species are dropped from one sample or another, leading to incorrect assessmets of community similarity. By rarefying a community, you arbitrarily reduce the effort you put in to characterise that community and reduce the scope and accuracy of your dataset. Instead, an alternative approach simply assesses all samples by calculating expected asymptotic species richness (using parametric extrapolation of the accumulation curve, or through non-parametric estimators such as the Chao index), and calculating the proportion of expected richness each sample achieved. If samples failed to meet a threshold proportion, they are discarded from the dataset (and ideally re-sequenced to achieve more reads and more ASVs/OTUs). The remaining samples are considered valid community samples and no removal of reads in performed. Generally a threshold in the region of 90% of expected richness is employed.</p>
<p>In either case, the majority of metabarcoding studies convert the reads table into presence-absence after using the read numbers for the above filtering. This reflects the fact that read counts in general are not accurate counts of relative ASV/OTU abundance, and it would be inappropriate to employ ecological analyses that treat these values as counts.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In conclusion, we recommend the following steps be performed to further filter the reads table before performing ecological analysis:</p>
<ol class="arabic simple">
<li><p>Examine read count distributions by sample and by ASV/OTU to identify thresholds of relative read count</p></li>
<li><p>Convert read counts under a threshold proportion of reads per sample to 0</p></li>
<li><p>Convert singleton read counts to 0</p></li>
<li><p>Standardise read counts either through</p></li>
<li><p>Rarefaction to a target read count, removing samples with reads below this target.</p></li>
<li><p>Calculation of expected ASV/OTU richness per sample, removing samples with observed richness less than a threshold proportion of expected.</p></li>
<li><p>Convert all read counts to presence-absence (i.e. any values &gt;1 changed to 1)</p></li>
</ol>
<p>The majority of these steps are relatively straightforward to perform in R.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../building_otu_phylogeny.html" class="btn btn-neutral float-right" title="Building OTU Phylogeny" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mapping_reads_otus.html" class="btn btn-neutral float-left" title="Mapping reads to OTUs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Vogler Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br>The content of this site is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Creative Commons Attribution ShareAlike 4.0 License</a></p>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>