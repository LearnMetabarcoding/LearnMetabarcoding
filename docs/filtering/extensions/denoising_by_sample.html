

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Extension: Denoising by sample &mdash; Bioinformatic Methods for Biodiversity Metabarcoding  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Indel filtering" href="../indel_filtering.html" />
    <link rel="prev" title="3. Frequency filtering / denoising" href="../freq_filtering_and_denoising.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Bioinformatic Methods for Biodiversity Metabarcoding
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Example data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readprocessing.html">A: Read processing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../filtering.html">B: Filtering amplicons</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quality_filtering.html">1. Quality filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../not_filtering_dereplication.html">2. (not filtering) Dereplication</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../freq_filtering_and_denoising.html">3. Frequency filtering / denoising</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Extension: Denoising by sample</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../indel_filtering.html">4. Indel filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../point_error.html">5. Point error filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chimera_filtering.html">6. Chimera filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metamate.html">Extension: Stringent ASV filtering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../asv_otu_readmap.html">C: ASVs, OTUs and read mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../building_otu_phylogeny.html">D: Building OTU phylogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../otuid.html">E: Identifying OTU sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contactus.html">Contact us</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Bioinformatic Methods for Biodiversity Metabarcoding</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../filtering.html">B: Filtering amplicons</a> &raquo;</li>
        
          <li><a href="../freq_filtering_and_denoising.html">3. Frequency filtering / denoising</a> &raquo;</li>
        
      <li>Extension: Denoising by sample</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/filtering/extensions/denoising_by_sample.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="extension-denoising-by-sample">
<span id="denoise-by-sample"></span><h1>Extension: Denoising by sample<a class="headerlink" href="#extension-denoising-by-sample" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Here we will denoise by each individual sample, rather than on the entire dataset. This requires us to go back to the data generated in an earlier tutorial. We strongly recommend making a separate directory to perform this experimentation in, and using clear file names so you don’t get the data mixed up!</p>
<div class="green admonition">
<p class="admonition-title">Data and software</p>
<p>The input data for this tutorial is a directory containing one FASTQ or FASTA file per sample. If you’ve been following along step-by-step, this is the data produced in the <a class="reference internal" href="../../processing/pair_merging.html#pair-merging"><span class="std std-ref">pair merging</span></a> tutorial in the previous section. Alternatively, the <code class="docutils literal notranslate"><span class="pre">3_merged</span></code> directory within the <a class="reference internal" href="../../data.html#sectionadata"><span class="std std-ref">sectionA archive</span></a> can be used as example data.</p>
<p>This extension uses the <a class="reference internal" href="../../gettingstarted/setup/installing_software.html#vsearch"><span class="std std-ref">VSEARCH</span></a> software.</p>
</div>
</div>
<div class="section" id="denoising-by-sample">
<h2>Denoising by sample<a class="headerlink" href="#denoising-by-sample" title="Permalink to this headline">¶</a></h2>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<ol class="arabic simple">
<li><p>If your input data is FASTQ files, quality filter each FASTA file using the <code class="docutils literal notranslate"><span class="pre">vsearch</span> <span class="pre">--fastx_filter...</span></code> command from the <a class="reference internal" href="../quality_filtering.html#quality-filtering"><span class="std std-ref">quality filtering</span></a> tutorial, but running individually on each sample one at a time using a bash loop (hint: there’s a loop command at the end of that tutorial).</p></li>
<li><p>Run the dereplication command (<code class="docutils literal notranslate"><span class="pre">vsearch</span> <span class="pre">--derep_fulllength...</span></code>) from the <a class="reference internal" href="../not_filtering_dereplication.html#dereplication"><span class="std std-ref">dereplication</span></a> tutorial on each sample individually using a bash loop</p></li>
<li><p>Run the denoising command (<code class="docutils literal notranslate"><span class="pre">vsearch</span> <span class="pre">--cluster_unoise...</span></code>) from the <a class="reference internal" href="../freq_filtering_and_denoising.html#denoising"><span class="std std-ref">denoising</span></a> tutorial on each sample individually using a bash loop</p></li>
<li><p>Concatenate the result files using <code class="docutils literal notranslate"><span class="pre">sed</span></code> in the same way as in the <a class="reference internal" href="../../processing/data_concat.html#data-concat"><span class="std std-ref">data concatenation</span></a> tutorial.</p></li>
<li><p>Re-dereplicate the output file using the following command:</p></li>
</ol>
<pre class="codebg literal-block">vsearch --derep_fulllength <span class="var">input.fasta</span> --sizein --sizeout --relabel uniq --output <span class="var">output.fasta</span></pre>
<ol class="arabic simple" start="6">
<li><p>Compare the total unique read numbers and size distributions of your output to the version produced by whole-dataset denoising</p></li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../indel_filtering.html" class="btn btn-neutral float-right" title="4. Indel filtering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../freq_filtering_and_denoising.html" class="btn btn-neutral float-left" title="3. Frequency filtering / denoising" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Vogler Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br>Creedy, Vogler & Penlington, Natural History Museum London, Bioinformatic Methods for Biodiversity Metabarcoding. This site is a a deliverable of the iBioGen consortium funded by EU grant agreement No 810729, the content of this site is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Creative Commons Attribution ShareAlike 4.0 License</a></p>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>