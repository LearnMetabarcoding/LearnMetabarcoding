

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Phylogenetic Classification &mdash; Bioinformatic Methods for Biodiversity Metabarcoding  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Extension: Mapping reads to references" href="mapping_reads_to_refs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Bioinformatic Methods for Biodiversity Metabarcoding
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readprocessing.html">Read processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filtering.html">Filtering Amplicon Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../otu_asv_read.html">OTUs, ASVs and Read Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_otu_phylogeny.html">Building OTU Phylogeny</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../otuid.html">Identifying OTU Sequences</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="database.html">Database Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="id_local.html">Identifying OTUs with References</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Phylogenetic Classification</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bioinformatic Methods for Biodiversity Metabarcoding</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../otuid.html">Identifying OTU Sequences</a> &raquo;</li>
        
      <li>Phylogenetic Classification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/otuid/phylogeny_based.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="phylogenetic-classification">
<span id="id1"></span><h1>Phylogenetic Classification<a class="headerlink" href="#phylogenetic-classification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>As we saw in the previous section (<a class="reference internal" href="../building_otu_phylogeny.html#phylogeny"><span class="std std-ref">Building OTU Phylogeny</span></a>), we can place OTUs onto phylogenetic trees constructed from reference sequences. If we then annotate the tree with the taxonomy of these reference sequences, we often observe OTUs placed within clades that correspond to a taxonomic group. Thus it follows that we should be able to use this tree to assign taxonomy to OTUs based on their placement.</p>
<p>The upside of using phylogeny for taxonomic classification is that the process of phylogenetic placement, if performed accurately, is much more thorough than similarity or local alignment used in the database-searching approaches. Since phylogenetic reconstruction takes account of all sequences in the dataset at the same time, the placement of an OTU in a phylogeny is much more accurate in showing the degree of relation between an OTU and references than a database search.</p>
<p>The downside of using phylogeny is that the size of the reference set is much more limited, by necessity of the increased computational requirements. Rather than using all possible sequences available on public databases, we are forced to select a limited taxonomic range and generally then only a subset of sequences within that range. This means that the application of phylogenetic placement to taxonomic classification is limited to a specific taxon, such as the Coleoptera, and the depth of classifications achieved is likely to be less than that of database classification.</p>
<p>The optimal classification may then be best achieved through a combination of broad scale database classification on the entire OTU set, then detailed phylogenetic placement for taxa of interest. Phylogenetic placement is best applied when you want certainty about the membership (or not) of a set of OTUs within a particular taxon, and accurate group-level placement within that taxon. For example, here we will place our OTUs onto a Coleoptera tree, which will provide us with clear evidence of which OTUs are Coleoptera or not. Then we will see which families the OTUs are placed within, giving us largely-accurate family-level assignment. However, genus or species assignments largely won’t be possible, as we simply don’t have the depth of coverage for this.</p>
</div>
<div class="section" id="data-and-software">
<h2>Data and software<a class="headerlink" href="#data-and-software" title="Permalink to this headline">¶</a></h2>
<p>You will need a phylogenetic tree with OTUs placed among a set of references with known taxonomy. If you have completed the <a class="reference internal" href="../otu_phylogeny/placing_otus_in_trees.html#phylogenetic-placement"><span class="std std-ref">Phylogenetic Placement</span></a> subsection, you will have generated this tree. You will also need a table recording taxonomy for the references.</p>
<p>You will also need two R scripts TODO</p>
</div>
<div class="section" id="approaches">
<h2>Approaches<a class="headerlink" href="#approaches" title="Permalink to this headline">¶</a></h2>
<p>This task has two main steps. First we must place OTUs onto a phylogenetic tree. We cover one way of doing this in the <a class="reference internal" href="../otu_phylogeny/placing_otus_in_trees.html#phylogenetic-placement"><span class="std std-ref">Phylogenetic Placement</span></a> subsection. The second step involves parsing the taxonomy of the references and inferring the taxonomy of the OTUs. We do this with some custom R scripts, because we find this option is the most flexible. Here we will use these R scripts as standalone tools, but if you’re familiar with R we suggest you open up the scripts and see what they’re doing. The key function within these scripts is the <code class="docutils literal notranslate"><span class="pre">`nodelabel.phylo</span></code> function from geiger &lt;<a class="reference external" href="https://www.rdocumentation.org/packages/geiger/versions/2.0.7/topics/nodelabel.phylo">https://www.rdocumentation.org/packages/geiger/versions/2.0.7/topics/nodelabel.phylo</a>&gt;`_, which does the work of assigning taxonomy to the internal nodes of the tree based on the tips.</p>
</div>
<div class="section" id="taxonomising-the-tree">
<h2>Taxonomising the tree<a class="headerlink" href="#taxonomising-the-tree" title="Permalink to this headline">¶</a></h2>
<p>First, we must assign taxonomy to the tree. We do this with the XXXX script. This script takes as input the tree and the taxonomy, and outputs a tree with taxonomic names assigned to some of the internal nodes. Assuming you have the script in your working directory, you would run it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rscript</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Download this tree and open it in your tree viewer. Have a look at the internal nodes, looking particularly for those to which the script has assigned taxonomy.
Do the nodes correspond with the tips?
Are the taxonomic groups always monophyletic?
Do most of the OTUs look like they’ll have taxonomy assigned?</p>
<p>Run the script again with strict on. Look at your new version of the tree. Have fewer nodes been assigned taxonomy? How will this affect the OTUs?</p>
</div>
</div>
<div class="section" id="inferring-otu-classification">
<h2>Inferring OTU classification<a class="headerlink" href="#inferring-otu-classification" title="Permalink to this headline">¶</a></h2>
<p>Now that we have our taxonomised tree, we can infer the OTU classification. This is performed with another Rscript, and the logic here is very straightforward: the script looks at the parent nodes of each OTU, and assigns the OTU the taxonomy of the most recent parent node with any taxonomy.</p>
<p>Run the script as follows, assuming you have the script in your working directory. We suggest you use the first taxonomised tree you generated, without strict taxonomisation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rscript</span>
</pre></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Download and open the taxonomy classification table. Check a few of the OTUs against the tree. Do they fit?</p>
<p>Have all the OTUs recieved the same depth of classification? Why might some have fewer or more taxonomic levels?</p>
<p>Compare the classification of some of the OTUs against the classification achieved by the database approaches. Can you see any discrepancies? Which do you think is more accurate?</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="mapping_reads_to_refs.html" class="btn btn-neutral float-left" title="Extension: Mapping reads to references" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Vogler Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br>The content of this site is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank">Creative Commons Attribution ShareAlike 4.0 License</a></p>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>